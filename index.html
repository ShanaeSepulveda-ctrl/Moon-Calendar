<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Cosmic Turtle Almanac</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --space-dark: #090514;
      --nebula-purple: #2a1b3d;
      --cosmic-glow: #b388ff;
      --starlight: #ffffff;
      --glass: rgba(20, 10, 40, 0.6);
      --glass-border: rgba(179, 136, 255, 0.3);
      --blood: #ff80ab;
    }

    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(to bottom, #05030a, #1a0b2e, #0f0518);
      color: #e0e0e0;
      margin: 0; padding: 10px;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* üåå BREATHING STARS BACKGROUND */
    .star-layer {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1;
    }
    .star {
      position: absolute; background: white; border-radius: 50%;
      box-shadow: 0 0 4px var(--starlight);
      animation: breathe 4s infinite ease-in-out;
    }
    @keyframes breathe { 0%, 100% { opacity: 0.3; transform: scale(0.8); } 50% { opacity: 1; transform: scale(1.2); } }

    /* üîÆ THE COMPACT ORACLE DASHBOARD */
    #oracleDash {
      width: 95%; max-width: 500px;
      background: var(--glass);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: 20px; margin: 10px 0 20px 0;
      box-shadow: 0 0 30px rgba(130, 87, 229, 0.15);
      display: flex; flex-direction: column; align-items: center;
      text-align: center;
    }

    .moon-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
    .main-moon-icon { font-size: 2.5rem; filter: drop-shadow(0 0 10px var(--cosmic-glow)); }
    .moon-title h2 { font-family: 'Cinzel'; margin: 0; color: var(--cosmic-glow); font-size: 1.4rem; letter-spacing: 2px; }
    .moon-subtitle { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.8; }

    .wisdom-box {
      border-top: 1px solid var(--glass-border);
      width: 100%; padding-top: 15px; margin-top: 5px;
      text-align: left;
    }
    .wisdom-label { font-family: 'Cinzel'; color: var(--cosmic-glow); font-size: 0.75rem; display: block; margin-bottom: 5px; }
    .wisdom-text { font-size: 0.95rem; line-height: 1.5; font-style: italic; color: #f0f0f0; margin-bottom: 15px; }

    /* üñãÔ∏è COMPACT JOURNAL */
    #journalInput {
      width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border);
      border-radius: 10px; padding: 10px; color: white; font-family: 'Quicksand';
      font-size: 0.9rem; height: 60px; box-sizing: border-box; resize: none; margin-bottom: 10px;
    }
    #journalInput:focus { border-color: var(--cosmic-glow); outline: none; }

    .action-row { display: flex; justify-content: space-between; width: 100%; align-items: center; }
    .cycle-btn {
      background: transparent; border: 1px solid var(--blood); color: var(--blood);
      padding: 6px 15px; border-radius: 20px; font-size: 0.75rem; cursor: pointer; transition: 0.3s;
      font-family: 'Cinzel';
    }
    .cycle-btn.active { background: var(--blood); color: white; box-shadow: 0 0 15px var(--blood); }

    /* üóìÔ∏è THE STAR GRID CALENDAR */
    .controls { display: flex; justify-content: space-between; width: 100%; max-width: 500px; margin-bottom: 10px; align-items: center; }
    .month-title { font-family: 'Cinzel'; font-size: 1.2rem; letter-spacing: 3px; color: var(--cosmic-glow); }
    .nav-btn { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; opacity: 0.7; }

    #calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; width: 100%; max-width: 500px; padding-bottom: 40px; }
    .day-label { font-size: 0.65rem; color: var(--cosmic-glow); text-align: center; opacity: 0.6; padding-bottom: 5px; font-family: 'Cinzel'; }

    .day {
      background: rgba(255,255,255,0.03); border-radius: 8px;
      aspect-ratio: 1/1.3; display: flex; flex-direction: column; align-items: center; justify-content: center;
      cursor: pointer; position: relative; border: 1px solid transparent;
      transition: 0.3s;
    }
    
    /* Active States */
    .day.today { border: 1px solid var(--starlight); background: rgba(255,255,255,0.08); box-shadow: 0 0 10px rgba(255,255,255,0.2); }
    .day.full-moon { background: radial-gradient(circle, rgba(179,136,255,0.2), transparent); border: 1px solid var(--cosmic-glow); box-shadow: 0 0 15px var(--cosmic-glow); }
    .day.new-moon { border: 1px solid #555; background: rgba(0,0,0,0.6); }
    .day.period { border: 1px solid var(--blood); background: rgba(255, 128, 171, 0.1); }

    .d-num { position: absolute; top: 4px; left: 5px; font-size: 0.6rem; opacity: 0.5; }
    .t-num { position: absolute; top: 4px; right: 5px; font-size: 0.6rem; color: var(--cosmic-glow); }
    .d-icon { font-size: 1.1rem; margin-top: 5px; }
    .d-zod { font-size: 0.55rem; margin-top: 2px; opacity: 0.8; }
    .d-turtle { position: absolute; bottom: 2px; font-size: 0.7rem; }

  </style>
</head>
<body>

  <div class="star-layer" id="starLayer"></div>

  <div class="controls">
    <button class="nav-btn" onclick="changeMonth(-1)">‚Äπ</button>
    <span class="month-title" id="monthLabel">JANUARY 2026</span>
    <button class="nav-btn" onclick="changeMonth(1)">‚Ä∫</button>
  </div>

  <div id="calendar"></div>

  <div id="oracleDash">
    <div class="moon-header">
      <div class="main-moon-icon" id="dashIcon">üåï</div>
      <div class="moon-title">
        <h2 id="dashTitle">WOLF MOON</h2>
        <div class="moon-subtitle" id="dashSub">FULL MOON IN CANCER</div>
      </div>
    </div>

    <div class="wisdom-box">
      <span class="wisdom-label">COSMIC WHISPER</span>
      <div class="wisdom-text" id="dashSpirit">The Wolf howls to locate its pack. Tonight, use your voice to find your people.</div>
      
      <span class="wisdom-label">TURTLE CYCLE RITUAL</span>
      <div class="wisdom-text" id="dashRitual">Light a silver candle. Speak your boundaries into the flame.</div>
    </div>

    <textarea id="journalInput" placeholder="What are you feeling in this moon phase?..." oninput="saveJournal()"></textarea>
    
    <div class="action-row">
      <div style="font-size: 0.7rem; opacity: 0.6;" id="currentDateDisplay"></div>
      <button id="cycleBtn" class="cycle-btn" onclick="togglePeriod()">mark cycle</button>
    </div>
  </div>

<script>
  // üåå GENERATE STARS
  const starLayer = document.getElementById('starLayer');
  for(let i=0; i<50; i++) {
    const s = document.createElement('div');
    s.className = 'star';
    s.style.left = Math.random() * 100 + '%';
    s.style.top = Math.random() * 100 + '%';
    s.style.width = Math.random() * 3 + 'px';
    s.style.height = s.style.width;
    s.style.animationDelay = Math.random() * 4 + 's';
    starLayer.appendChild(s);
  }

  // üê¢ DATA & STATE
  let activeD = new Date(2026, 0, 15); // Start on Jan 15, 2026
  let db = JSON.parse(localStorage.getItem('cosmic_turtle_v28')) || { logs: {}, journals: {} };

  // üåë NASA 2026 DATA (Hardcoded for Perfection)
  // Format: "Month-Day": { type, sign } (Month is 0-indexed)
  const LUNAR_EVENTS = {
    "0-3": { t: "FULL", s: "Cancer ‚ôã" },   // Jan 3
    "0-18": { t: "NEW", s: "Capricorn ‚ôë" }, // Jan 18
    "1-1": { t: "FULL", s: "Leo ‚ôå" },      // Feb 1
    "1-17": { t: "NEW", s: "Aquarius ‚ôí" },  // Feb 17
    "2-3": { t: "FULL", s: "Virgo ‚ôç" },    // Mar 3
    "2-19": { t: "NEW", s: "Pisces ‚ôì" }     // Mar 19
  };

  const MOON_NAMES = ["Wolf Moon üê∫", "Snow Moon ‚ùÑÔ∏è", "Worm Moon ü™±", "Pink Moon üå∏", "Flower Moon üíê", "Strawberry Moon üçì", "Buck Moon ü¶å", "Sturgeon Moon üêü", "Harvest Moon üåæ", "Hunter's Moon üèπ", "Beaver Moon ü¶´", "Cold Moon üåï"];

  function getCosmicInfo(date) {
    const m = date.getMonth();
    const d = date.getDate();
    const key = `${m}-${d}`;

    // 1. Turtle Cycle (Anchor March 20 Equinox)
    const equinox = new Date(2026, 2, 20).getTime();
    const diff = Math.floor((date.getTime() - equinox) / (86400000));
    let tDay = (diff % 28) + 1;
    if (tDay <= 0) tDay += 28;

    // 2. Zodiac Approximation (Fallback if not a major moon day)
    // Jan 1 = Gemini/Cancer transition. Rough +1 sign every 2.5 days.
    const zList = ["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces"];
    const jan1 = new Date(2026, 0, 1).getTime();
    const dayOfYear = Math.floor((date.getTime() - jan1)/86400000);
    let zIdx = Math.floor((2 + (dayOfYear * 0.4))) % 12; // Starts roughly Gemini
    let zodiac = zList[zIdx];

    // 3. Phase Logic
    let icon = "üåô";
    let type = "Waning";
    let isFull = false, isNew = false;

    // Check Hardcoded NASA Events
    if (LUNAR_EVENTS[key]) {
      const event = LUNAR_EVENTS[key];
      type = event.t === "FULL" ? "Full Moon" : "New Moon";
      zodiac = event.s;
      icon = event.t === "FULL" ? "üåï" : "üåë";
      isFull = event.t === "FULL";
      isNew = event.t === "NEW";
    } else {
      // Interpolate visuals based on turtle day
      if (tDay === 1) icon = "üåë"; 
      else if (tDay < 14) icon = "üåî"; 
      else if (tDay === 14) icon = "üåï"; 
      else icon = "üåò";
    }

    return { icon, type, zodiac, tDay, isFull, isNew };
  }

  function render() {
    const grid = document.getElementById("calendar");
    grid.innerHTML = "";
    document.getElementById("monthLabel").innerText = activeD.toLocaleString('default', { month: 'long', year: 'numeric' });

    // Day Headers
    ["SUN","MON","TUE","WED","THU","FRI","SAT"].forEach(d => {
      const h = document.createElement("div"); h.className = "day-label"; h.innerText = d; grid.appendChild(h);
    });

    const yr = activeD.getFullYear(), mo = activeD.getMonth();
    const first = new Date(yr, mo, 1);
    const last = new Date(yr, mo + 1, 0).getDate();
    
    // Padding
    for(let i=0; i<first.getDay(); i++) grid.appendChild(document.createElement("div"));

    // Days
    for(let i=1; i<=last; i++) {
      const d = new Date(yr, mo, i);
      const data = getCosmicInfo(d);
      const cell = document.createElement("div");
      cell.className = "day";
      
      // Classes
      if (d.toDateString() === new Date().toDateString()) {
        cell.classList.add("today");
        cell.innerHTML += `<span class="d-turtle">üê¢</span>`;
      }
      if (data.isFull) cell.classList.add("full-moon");
      if (data.isNew) cell.classList.add("new-moon");
      if (db.logs[d.toDateString()]) cell.classList.add("period");

      // Content
      cell.innerHTML += `
        <span class="d-num">${i}</span>
        <span class="t-num">${data.tDay}</span>
        <span class="d-icon">${data.icon}</span>
        <span class="d-zod">${data.zodiac.split(' ')[0].substring(0,3)}</span>
      `;
      
      cell.onclick = () => loadDashboard(d);
      grid.appendChild(cell);
    }
  }

  function loadDashboard(date) {
    activeD = new Date(date);
    const data = getCosmicInfo(date);
    const moonName = MOON_NAMES[date.getMonth()];
    
    document.getElementById("dashIcon").innerText = data.icon;
    document.getElementById("dashTitle").innerText = data.isFull ? "FULL " + moonName.split(' ')[0] + " MOON" : moonName.split(' ')[0] + " MOON";
    document.getElementById("dashSub").innerText = `${data.type} IN ${data.zodiac.toUpperCase()} ‚Ä¢ TURTLE DAY ${data.tDay}`;
    document.getElementById("currentDateDisplay").innerText = date.toLocaleDateString();

    // üîÆ DYNAMIC FEMININE GUIDANCE
    let spirit = "The stars are silent, asking you to listen to your inner rhythm.";
    let ritual = "Close your eyes. Breathe in starlight, breathe out shadow.";
    
    // Customized by Phase & Sign
    if(data.isFull) {
        spirit = "The Mother is at her peak brightness. What have you birthed this cycle that is ready to be seen?";
        ritual = "Place your crystals or jewelry in the moonlight to cleanse them of old energy.";
    } else if (data.isNew) {
        spirit = "The sky is a fertile void. In the darkness, the seed does its most important work.";
        ritual = "Write down one intention. Plant it in soil or keep it in a dark box.";
    } else if (data.zodiac.includes("Cancer")) {
        spirit = "You are swimming in the waters of the home and heart. It is safe to be soft.";
    } else if (data.zodiac.includes("Leo")) {
        spirit = "Your heart is a sun. Do not apologize for burning bright.";
    }

    document.getElementById("dashSpirit").innerText = spirit;
    document.getElementById("dashRitual").innerText = ritual;
    
    // Journal
    document.getElementById("journalInput").value = db.journals[date.toDateString()] || "";
    const btn = document.getElementById("cycleBtn");
    btn.className = db.logs[date.toDateString()] ? "cycle-btn active" : "cycle-btn";
    btn.innerText = db.logs[date.toDateString()] ? "CYCLE LOGGED" : "LOG CYCLE";
  }

  function togglePeriod() {
    const k = activeD.toDateString(); 
    db.logs[k] = !db.logs[k];
    localStorage.setItem('cosmic_turtle_v28', JSON.stringify(db));
    render(); loadDashboard(activeD);
  }

  function saveJournal() {
    db.journals[activeD.toDateString()] = document.getElementById("journalInput").value;
    localStorage.setItem('cosmic_turtle_v28', JSON.stringify(db));
  }

  function changeMonth(n) { activeD.setMonth(activeD.getMonth() + n); render(); }

  // Init
  render();
  loadDashboard(new Date()); // Load today
</script>
</body>
</html>
