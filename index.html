<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13 Moon Calendar</title>
    
<script src="https://unpkg.com/suncalc@1.9.0/suncalc.js"></script>
    
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #0b0d17;
      color: #eee;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    #calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
    }

    .day {
      background: #15192d;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      min-height: 90px;
      transition: background 0.2s;
    }

    .day:hover {
      background: #1f2550;
    }

    .gregorian {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    .moon-day {
      font-size: 1.2rem;
      font-weight: bold;
      margin-top: 5px;
    }

    .moon-name {
      font-size: 0.75rem;
      opacity: 0.8;
      margin-top: 4px;
    }

    #dayInfo {
      margin-top: 30px;
      padding: 20px;
      border-radius: 12px;
      background: #15192d;
    }
    
 .day.today {
  border: 1px solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 0 12px rgba(180, 200, 255, 0.6);
  background: radial-gradient(
    circle at top,
    rgba(255, 255, 255, 0.08),
    #15192d
  );
}

/* Optional gentle pulse */
@keyframes softGlow {
  0% { box-shadow: 0 0 8px rgba(180, 200, 255, 0.4); }
  50% { box-shadow: 0 0 16px rgba(180, 200, 255, 0.8); }
  100% { box-shadow: 0 0 8px rgba(180, 200, 255, 0.4); }
}

.day.today {
  animation: softGlow 4s ease-in-out infinite;
}

#lunarGuidance {
  background: linear-gradient(160deg, #15192d, #0b0d17);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 25px;
  box-shadow: 0 0 20px rgba(180, 200, 255, 0.15);
}

#lunarGuidance h2 {
  margin-top: 0;
  text-align: center;
}

#lunarGuidance p {
  line-height: 1.4;
  margin: 10px 0;
}

  </style>
    
    <link rel="manifest" href="manifest.json">

</head>

<body>
  <h1>13 Moon Calendar</h1>

<div id="lunarGuidance">
  <h2>ðŸŒ™ Todayâ€™s Lunar Guidance</h2>
  <p id="lunarPhase"></p>
  <p><strong>Affirmation:</strong> <span id="affirmation"></span></p>
  <p><strong>Suggested Ritual:</strong> <span id="ritual"></span></p>
</div>

  <div id="calendar"></div>

  <div id="dayInfo">
    <h2>Selected Day</h2>
    <p id="dayText">Click a day to see its energy.</p></div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  var calendar = document.getElementById("calendar");
  var dayText = document.getElementById("dayText");

  var todayDate = new Date();

  function getMoonPhase(date) {
    if (typeof SunCalc === "undefined") return "ðŸŒ™ Moon";

    var phase = SunCalc.getMoonIllumination(date).phase;

    if (phase < 0.03 || phase > 0.97) return "ðŸŒ‘ New Moon";
    if (phase < 0.22) return "ðŸŒ’ Waxing Crescent";
    if (phase < 0.28) return "ðŸŒ“ First Quarter";
    if (phase < 0.47) return "ðŸŒ” Waxing Gibbous";
    if (phase < 0.53) return "ðŸŒ• Full Moon";
    if (phase < 0.72) return "ðŸŒ– Waning Gibbous";
    if (phase < 0.78) return "ðŸŒ— Last Quarter";
    return "ðŸŒ˜ Waning Crescent";
  }
  
function getLunarGuidance(phase) {
  var guidance = {
    "ðŸŒ‘ New Moon": {
      affirmation: "I welcome new beginnings with clarity and trust.",
      ritual: "Set intentions in a journal or sit quietly with what is ready to be born.",
      message: "This is a sacred pause. Listen inward and allow new seeds to form."
    },
    "ðŸŒ’ Waxing Crescent": {
      affirmation: "I gently nurture what is growing within me.",
      ritual: "Take one small aligned action toward a goal or dream.",
      message: "Growth is subtle today. Honor small steps and quiet momentum."
    },
    "ðŸŒ“ First Quarter": {
      affirmation: "I move forward with courage and commitment.",
      ritual: "Clear obstacles or make a decision youâ€™ve been postponing.",
      message: "Tension invites clarity. Choose forward motion with intention."
    },
    "ðŸŒ” Waxing Gibbous": {
      affirmation: "I refine my path with patience and awareness.",
      ritual: "Adjust plans and release perfectionism.",
      message: "Refinement brings wisdom. Let your vision evolve."
    },
    "ðŸŒ• Full Moon": {
      affirmation: "I honor my growth and release what no longer serves me.",
      ritual: "Practice a release ritual or celebrate how far youâ€™ve come.",
      message: "Illumination is strong. Feel fully, release gently, celebrate truth."
    },
    "ðŸŒ– Waning Gibbous": {
      affirmation: "I integrate wisdom gained through experience.",
      ritual: "Share gratitude or reflect on recent insights.",
      message: "Meaning settles in now. Let lessons land softly."
    },
    "ðŸŒ— Last Quarter": {
      affirmation: "I release with compassion and intention.",
      ritual: "Let go of habits, commitments, or thoughts that drain you.",
      message: "Clearing creates space. Choose what truly supports you."
    },
    "ðŸŒ˜ Waning Crescent": {
      affirmation: "I rest, restore, and prepare for renewal.",
      ritual: "Slow down, rest deeply, or spend time in quiet reflection.",
      message: "This is a time of rest and surrender. Restoration is sacred."
    }
  };

  return guidance[phase] || {
    affirmation: "I flow with the natural rhythms of life.",
    ritual: "Pause and take a mindful breath.",
    message: "Move gently and listen to what your body and spirit need."
  };
}
 
  function getMoonDayMeaning(moonDay) {
  var meanings = {
    1:  "Initiation â€” a spark of beginning energy is present.",
    2:  "Polarity â€” notice balance, contrast, and relationship.",
    3:  "Activation â€” movement begins; ideas want expression.",
    4:  "Form â€” structure and boundaries support growth.",
    5:  "Empowerment â€” confidence and personal power rise.",
    6:  "Balance â€” harmony, care, and adjustment are needed.",
    7:  "Reflection â€” pause, observe, and realign.",
    8:  "Integration â€” lessons begin to settle into the body.",
    9:  "Intention â€” refocus on what truly matters.",
    10: "Manifestation â€” effort meets visible outcome.",
    11: "Release â€” clear tension, emotion, or resistance.",
    12: "Understanding â€” insight and perspective deepen.",
    13: "Transformation â€” something shifts at the core.",
    14: "Illumination â€” truth is revealed; clarity peaks.",
    15: "Expression â€” share, communicate, or celebrate.",
    16: "Adjustment â€” course-correct with compassion.",
    17: "Trust â€” surrender control and allow flow.",
    18: "Healing â€” tend to emotional or physical needs.",
    19: "Completion â€” acknowledge what has been fulfilled.",
    20: "Devotion â€” recommit to what nourishes you.",
    21: "Expansion â€” openness and possibility widen.",
    22: "Mastery â€” skills and wisdom stabilize.",
    23: "Flow â€” allow ease and natural movement.",
    24: "Gratitude â€” appreciation softens and opens the heart.",
    25: "Surrender â€” release expectations and outcomes.",
    26: "Clearing â€” simplify, declutter, cleanse.",
    27: "Stillness â€” quiet awareness prepares renewal.",
    28: "Renewal â€” rest, reset, and prepare to begin again."
  };

  return meanings[moonDay] || "";
}

  function getFirstNewMoonOfYear(year) {
  for (var month = 0; month < 12; month++) {
    for (var day = 1; day <= 31; day++) {
      var date = new Date(year, month, day);
      if (date.getMonth() !== month) continue;

      var phase = SunCalc.getMoonIllumination(date).phase;
      if (phase < 0.03 || phase > 0.97) {
        return date;
      }
    }
  }
  return null;
}

  function getLunarPosition(date) {
  var year = date.getFullYear();
  var lunarYearStart = getFirstNewMoonOfYear(year);

  // If date is BEFORE this year's New Moon, use last year's
  if (date < lunarYearStart) {
    lunarYearStart = getFirstNewMoonOfYear(year - 1);
  }

  var msPerDay = 1000 * 60 * 60 * 24;
  var daysSinceStart = Math.floor(
    (date - lunarYearStart) / msPerDay
  );

  var moonNumber = Math.floor(daysSinceStart / 28) + 1;
  var moonDay = (daysSinceStart % 28) + 1;

  return {
    moonNumber: moonNumber <= 13 ? moonNumber : null,
    moonDay: moonDay,
    lunarYearStart: lunarYearStart
  };
}

  function renderMonth(year, month) {
    calendar.innerHTML = "";

    var firstDay = new Date(year, month, 1);
    var daysInMonth = new Date(year, month + 1, 0).getDate();

    for (var i = 0; i < firstDay.getDay(); i++) {
      calendar.appendChild(document.createElement("div"));
    }

    for (var day = 1; day <= daysInMonth; day++) {
      var date = new Date(year, month, day);

      var isToday =
        date.getDate() === todayDate.getDate() &&
        date.getMonth() === todayDate.getMonth() &&
        date.getFullYear() === todayDate.getFullYear();

      var lunar = getLunarPosition(date);
      var moonDay = lunar.moonDay;
      var moonNumber = lunar.moonNumber;

      var moonPhase = getMoonPhase(date);
      
      var cell = document.createElement("div");
      cell.className = "day";
      if (isToday) cell.classList.add("today");

cell.innerHTML =
  '<div class="gregorian">' + date.toDateString() + '</div>' +
  '<div class="moon-day">Moon ' + moonNumber + ' Â· Day ' + moonDay + '</div>' +
  '<div class="moon-name">' + moonPhase + '</div>';

      cell.onclick = function (d, md, mp) {
  return function () {
    var guidance = getLunarGuidance(mp);

    dayText.innerText =
      d.toDateString() +
      "\n" + mp +
      "\nMoon Day " + md +
      "\n\n" + guidance.message +
      "\n\nAffirmation:\n" + guidance.affirmation +
      "\n\nSuggested Ritual:\n" + guidance.ritual;
  };
}(date, moonDay, moonPhase);

      calendar.appendChild(cell);
    }
  }

  var now = new Date();
  renderMonth(now.getFullYear(), now.getMonth());

var todayPhase = getMoonPhase(todayDate);
var guidance = getLunarGuidance(todayPhase);

document.getElementById("lunarPhase").innerText = todayPhase;
document.getElementById("affirmation").innerText = guidance.affirmation;
document.getElementById("ritual").innerText = guidance.ritual;
});
</script>

</body>
</html>
